<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
    <title>Portfolio - KelloTek</title>
    <link rel="stylesheet" href="./styles/output.css">
    <script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body class="bg-custom-black text-white">
    <div id="app"></div>
    <script type="text/babel">
        const username = "KelloTek"
        const token = ""

        // Navigation Bar
        function NavBar({ username, token }) {
            const [profileData, setProfileData] = React.useState(null)
            const [error, setError] = React.useState(null)

            React.useEffect(() => {
                async function fetchGitHubProfile() {
                    try {
                        const response = await fetch(`https://api.github.com/users/${username}`, {
                            headers: {
                                Authorization: `Baerer ${token}`,
                            },
                        })

                        if(!response.ok) {
                            throw new Error(`GitHub user not found: ${response.statusText}`)
                        }

                        const data = await response.json()
                        setProfileData(data)
                    } catch (error) {
                        setError(error.message)
                    }
                }

                fetchGitHubProfile()
            }, [username, token])

            if(error) {
                return <p>Error: {error}</p>
            }

            if(profileData) {
                return (
                    <nav className="fixed flex w-full p-5 z-40 bg-custom-black shadow-xl">
                        <div className="flex justify-start">
                            <div className="flex items-center">
                                <box-icon class="fill-custom-blue" type="none" name="moon" size="3rem"></box-icon>
                            </div>
                        </div>
                        <div className="flex justify-end w-full">
                            <div className="flex items-center">
                                <div className="flex flex-col items-end">
                                    <h2 className="text-2xl font-bold">{profileData.name || profileData.login}</h2>
                                    <a className="no-underline text-custom-blue" href={profileData.html_url} target="_blank">Voir mon profil GitHub</a>
                                </div>
                                <img className="flex w-[80px] rounded-[50px] ml-5" src={profileData.avatar_url} alt={`${profileData.login}'s avatar`}/>
                            </div>
                        </div>
                    </nav>
                )
            }

            return <p>Loading...</p>
        }

        // Repositories
        function Repositories({ username, token }) {
            const [repos, setRepos] = React.useState(null)
            const [error, setError] = React.useState(null)

            React.useEffect(() => {
                async function fetchGitHubRepos() {
                    try {
                        const response = await fetch(`https://api.github.com/users/${username}/repos`, {
                            headers: {
                                Authorization: `Baerer ${token}`,
                            },
                        })

                        if(!response.ok) {
                            throw new Error(`GitHub repos not found: ${response.statusText}`)
                        }

                        const reposData = await response.json()
                        setRepos(reposData)
                    } catch (error) {
                        setError(error.message)
                    }
                }

                fetchGitHubRepos()
            }, [username, token])

            if(error) {
                return <p>Error: {error}</p>
            }

            if(repos) {
                if(repos.length > 0) {
                    return (
                        <div>
                            {repos.map((repo) => (
                                <div className="border-custom-blue border-2 p-[10px] rounded-xl hover:bg-custom-blue-2" key={repo.id}>
                                    <h3 className="text-xl font-bold text-custom-blue"><a href={repo.html_url} target="_blank">{repo.name}</a></h3>
                                    <p className="m-[5px] mb-5 text-custom-gray">{repo.description || "No description available."}</p>
                                    <div className="flex items-end">
                                        <p className="text-sm">Last updated: {new Date(repo.updated_at).toLocaleDateString()}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    )
                }
            }

            return <p>Loading repositories...</p>
        }

        // Card
        function Card(props) {
            return (
                <div className="flex flex-col items-center border-custom-blue border-2 rounded-xl p-5">
                    <box-icon class="fill-custom-blue" type={props.type} name={props.icon} size="3rem"></box-icon>
                    <p className="font-semibold mt-2">{props.text}</p>
                    <p className="text-custom-gray">{props.desc}</p>
                </div>
            )
        }

        // Modal
        function Modal(props) {
            return (
                <div className={`fixed flex justify-center items-center inset-0 bg-1A bg-opacity-85 z-50 ${ props.isOpen ? "block" : "hidden" }`} onClick={props.onClose}>
                    <div className="fixed flex justify-center items-center inset-0">
                        <div className="flex bg- p-6 rounded-lg max-w-2xl w-full" onClick={(e) => e.stopPropagation()}>
                            <button className="absolute top-0 right-2 text-white text-3xl" onClick={props.onClose}>&times;</button>
                            <div className="relative flex flex-col justify-center items-center pointer-events-none select-none">
                                <p className="w-full shadow-2xl text-white">Test</p>
                            </div>
                        </div>
                    </div>
                </div>
            )
        }

        // App
        function App() {
            const [isOpen, setIsOpen] = React.useState(false)

            return (
                <div>
                    {/* Navigation Bar*/}
                    <NavBar username={username} token={token}/>

                    <main>
                        {/* About us */}
                        <section className="flex justify-center w-full pt-48">
                            <div className="flex flex-col items-center">
                                <h2 className="text-4xl font-bold mb-10">A Propos de moi</h2>
                                <div className="grid gap-4 grid-cols-3">
                                    <Card text="Créatif" type="solid" icon="save"/>
                                    <Card text="Capacité d'adaptation" type="solid" icon="server"/>
                                    <Card text="Autonome" type="solid" icon="battery-charging"/>
                                </div>
                                <p className="text-custom-gray text-center mt-5">
                                    Développeur web passionnée par la création.
                                    Toujours à la recherche de nouveaux défis.
                                </p>
                            </div>
                        </section>

                        {/* Skills */}
                        <section className="flex justify-center w-full mt-32">
                            <div className="flex flex-col items-center">
                                <h2 className="text-4xl font-bold mb-10">Compétences</h2>
                                <div className="grid gap-4 grid-cols-3">
                                    <Card text="HTML" desc="Intermédaire" type="logo" icon="html5"/>
                                    <Card text="CSS" desc="Intermédaire" type="logo" icon="css3"/>
                                    <Card text="JavaScript" desc="Intermédaire" type="logo" icon="javascript"/>
                                    <Card text="Java" desc="Intermédaire" type="logo" icon="java"/>
                                    <Card text="Figma" desc="Les bases" type="logo" icon="figma"/>
                                    <Card text="Blender" desc="Les bases" type="logo" icon="blender"/>
                                    <Card text="Anglais" desc="Les bases" type="solid" icon="user-voice"/>
                                </div>
                            </div>
                        </section>

                        {/* Journey */}
                        <section className="flex justify-center w-full pt-32">
                            <div className="flex flex-col items-center">
                                <h2 className="text-4xl font-bold mb-10">Mon Parcours</h2>
                                <div className="grid gap-4 grid-cols-3">
                                    <Card text="CAP Electricien" desc="CFAS Clermont-Ferrand" onClick={() => setIsOpen(true)}/>
                                </div>
                            </div>
                        </section>

                        {/* Repositories */}
                        <section className="flex justify-center w-full mt-32">
                            <div className="flex flex-col items-center w-4/5">
                                <h2 className="text-4xl font-bold mb-10">Repositories</h2>
                                <div className="grid gap-4 grid-cols-2">
                                    <Repositories username={username} token={token}/>
                                </div>
                            </div>
                        </section>
                    </main>

                    <Modal isOpen={isOpen} onClose={() => setIsOpen(false)}/>
                </div>
            )
        }

        ReactDOM.render(<App/>, document.getElementById("app"))
    </script>
    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
</body>
</html>